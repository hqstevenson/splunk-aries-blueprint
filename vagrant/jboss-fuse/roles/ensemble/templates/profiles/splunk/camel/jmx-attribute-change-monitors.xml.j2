<?xml version="1.0" encoding="UTF-8" ?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

    <!--
        This isn't needed for JBoss Fuse 6.3
        <type-converters>
            <bean id="event-builder-converter" class="com.pronoia.splunk.aries.blueprint.converter.EventBuilderConverter" />
        </type-converters>
     -->

    <splunk-jmx-attribute-change-monitor id="camel-context-statistics-monitor" xmlns="urn:pronoia.com/schema/blueprint/splunk"
                                         granularity-period="15" max-suppressed-duplicate-events="20">
        <observed-object>org.apache.camel:type=context,*</observed-object>
        <observed-attributes>
            <attribute>CamelId</attribute>
            <attribute>ExchangesCompleted</attribute>
            <attribute>ExchangesFailed</attribute>
            <attribute>ExchangesInflight</attribute>
            <attribute>ExchangesTotal</attribute>
            <attribute>ExternalRedeliveries</attribute>
            <attribute>FailuresHandled</attribute>
            <attribute>FirstExchangeCompletedExchangeId</attribute>
            <attribute>FirstExchangeCompletedTimestamp</attribute>
            <attribute>FirstExchangeFailureExchangeId</attribute>
            <attribute>FirstExchangeFailureTimestamp</attribute>
            <attribute>InflightExchanges</attribute>
            <attribute>LastExchangeCompletedExchangeId</attribute>
            <attribute>LastExchangeCompletedTimestamp</attribute>
            <attribute>LastExchangeFailureExchangeId</attribute>
            <attribute>LastExchangeFailureTimestamp</attribute>
            <attribute>MaxProcessingTime</attribute>
            <attribute>MeanProcessingTime</attribute>
            <attribute>MinProcessingTime</attribute>
            <attribute>Redeliveries</attribute>
            <attribute>ResetTimestamp</attribute>
            <attribute>StartTimestamp</attribute>
            <attribute>StartedRoutes</attribute>
            <attribute>State</attribute>
            <attribute>TotalRoutes</attribute>
        </observed-attributes>
        <collected-attributes>
            <attribute>TotalProcessingTime</attribute>
            <attribute>Uptime</attribute>
        </collected-attributes>
        <splunk-event index="{{ splunk_jboss_fuse_jmx_index }}" sourcetype="camel-context-statistics" >
            <system-property property="karaf.name" field="container" />
        </splunk-event>
    </splunk-jmx-attribute-change-monitor>

    <splunk-jmx-attribute-change-monitor id="camel-route-statistics-monitor" xmlns="urn:pronoia.com/schema/blueprint/splunk"
                                         granularity-period="15" max-suppressed-duplicate-events="20">
        <observed-object>org.apache.camel:type=routes,*</observed-object>
        <observed-attributes>
            <attribute>CamelId</attribute>
            <attribute>ExchangesCompleted</attribute>
            <attribute>ExchangesFailed</attribute>
            <attribute>ExchangesInflight</attribute>
            <attribute>ExchangesTotal</attribute>
            <attribute>ExternalRedeliveries</attribute>
            <attribute>FailuresHandled</attribute>
            <attribute>FirstExchangeCompletedExchangeId</attribute>
            <attribute>FirstExchangeCompletedTimestamp</attribute>
            <attribute>FirstExchangeFailureExchangeId</attribute>
            <attribute>FirstExchangeFailureTimestamp</attribute>
            <attribute>InflightExchanges</attribute>
            <attribute>LastExchangeCompletedExchangeId</attribute>
            <attribute>LastExchangeCompletedTimestamp</attribute>
            <attribute>LastExchangeFailureExchangeId</attribute>
            <attribute>LastExchangeFailureTimestamp</attribute>
            <attribute>MaxProcessingTime</attribute>
            <attribute>MeanProcessingTime</attribute>
            <attribute>MinProcessingTime</attribute>
            <attribute>OldestInflightDuration</attribute>
            <attribute>OldestInflightExchangeId</attribute>
            <attribute>Redeliveries</attribute>
            <attribute>ResetTimestamp</attribute>
            <attribute>RouteId</attribute>
            <attribute>StartTimestamp</attribute>
            <attribute>State</attribute>
        </observed-attributes>
        <collected-attributes>
            <attribute>Uptime</attribute>
        </collected-attributes>
        <splunk-event index="{{ splunk_jboss_fuse_jmx_index }}" sourcetype="camel-route-statistics" >
            <system-property property="karaf.name" field="container" />
        </splunk-event>
    </splunk-jmx-attribute-change-monitor>

</blueprint>